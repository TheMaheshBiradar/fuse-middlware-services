<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:camel="http://camel.apache.org/schema/spring"
	xmlns:osgi="http://www.springframework.org/schema/osgi" xmlns:cxf="http://camel.apache.org/schema/cxf"
	xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd  http://www.springframework.org/schema/osgi http://www.springframework.org/schema/osgi/spring-osgi.xsd       http://camel.apache.org/schema/spring http://camel.apache.org/schema/spring/camel-spring.xsd       http://camel.apache.org/schema/cxf http://camel.apache.org/schema/cxf/camel-cxf-2.8.3.xsd">


	<!-- Interceptor declaration start -->
	<bean id="loggingOutInterceptor" class="org.apache.cxf.interceptor.LoggingOutInterceptor" />
	<bean id="loggingInInterceptor" class="org.apache.cxf.interceptor.LoggingInInterceptor" />

	<!-- End point declaration Starts -->
	<cxf:cxfEndpoint id="bookTicketServiceCall"
		address="http://10.224.202.86:8181/bookTicketWithServiceMix/services/BookTicketImplPort"
		wsdlURL="wsdl/bookticket.wsdl" xmlns:ns="http://service.poc.venkat.com/"
		endpointName="ns:BookTicketImplPort" serviceName="ns:BookTicketImplService"
		serviceClass="com.venkat.poc.service.BookTicket">

		<cxf:inInterceptors>
			<ref bean="loggingInInterceptor" />
		</cxf:inInterceptors>
		<cxf:outInterceptors>
			<ref bean="loggingOutInterceptor" />
		</cxf:outInterceptors>

		<cxf:features>
			<bean class="org.apache.cxf.feature.LoggingFeature" />
		</cxf:features>
	</cxf:cxfEndpoint>


	<!-- Bean Declarations starts -->
	<bean id="bookProcessBean" class="com.venkat.poc.service.beans.BookTicketBean" />
	<bean id="bookTicketImpl" class="com.venkat.poc.service.impl.BookTicketImpl">

	</bean>

	<camelContext id="camelId" xmlns="http://camel.apache.org/schema/spring">
		<camel:dataFormats>
			<camel:jaxb id="jaxb" contextPath="com.venkat.poc.service" />
		</camel:dataFormats>

		<camel:route id="bookTicket">
			<camel:from uri="cxf:bean:bookTicketServiceCall" />
			<camel:marshal ref="jaxb" id="input" />
			<camel:bean ref="processBean" method="inputProcess" />
			<camel:to uri="direct:inputeEnd" />
			<log
				message="SOAP message received : ${body} and operation type : ${in.header.SOAPAction}" />

		</camel:route>
		<camel:route>
			<camel:from uri="direct:inputeEnd" />
			<camel:unmarshal ref="jaxb" />
			<camel:to uri="cxf:bean:bookTicketServiceCall" />
			<log
				message="SOAP message response : ${body} and operation type : ${in.header.SOAPAction}" />

		</camel:route>

	</camelContext>

<!-- 
	<camelContext id="camelId1" xmlns="http://camel.apache.org/schema/spring">

		<camel:route id="ticket">
			<camel:from uri="cxf:bean:bookTicketServiceCall" />
			<camel:choice>
				<camel:when>
					<camel:simple>${in.header.SOAPAction is bookTicket}</camel:simple>
					<camel:convertBodyTo type="com.venkat.poc.service.BooTicket_Type" />
					<camel:transform>
						<camel:method bean="bookTicketImplProcess" method="bookTicketProcess(${body})" />
					</camel:transform>
				</camel:when>
				<camel:when>
					<camel:simple>${in.header.SOAPAction is cancelTicket}
					</camel:simple>
					<camel:convertBodyTo type="com.venkat.poc.service.Ticket" />
					<camel:transform>
						<camel:method bean="bookTicketImplProcess" method="cancelTicketProcess(${body})" />
					</camel:transform>
				</camel:when>
			</camel:choice>

			
		</camel:route>

	</camelContext> -->

	<bean id="bookTicketImplProcess" class="com.venkat.poc.service.impl.BookTicketImplProcess" />

</beans>